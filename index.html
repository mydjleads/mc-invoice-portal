<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mark Chill - DJ Invoice Portal</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
:root {
  --bg: #0a0a0a; --card: #141414; --card-border: #222;
  --accent: #e8a849; --accent-hover: #f0b85a;
  --text: #f0f0f0; --text-muted: #888;
  --input-bg: #1a1a1a; --input-border: #333; --input-focus: #e8a849;
  --success: #4ade80; --danger: #f87171;
}
body { font-family: 'Inter', -apple-system, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; line-height: 1.5; }
.screen:not(.active) { display: none !important; }
.login-screen.active { min-height: 100vh; display: flex !important; align-items: center; justify-content: center; padding: 20px; }
.login-card { background: var(--card); border: 1px solid var(--card-border); border-radius: 16px; padding: 48px 40px; max-width: 420px; width: 100%; text-align: center; }
.brand-logo { font-weight: 700; font-size: 28px; letter-spacing: 4px; text-transform: uppercase; margin-bottom: 8px; color: var(--accent); }
.brand-sub { color: var(--text-muted); font-size: 13px; letter-spacing: 1px; text-transform: uppercase; margin-bottom: 36px; }
.dj-select-label { display: block; text-align: left; font-size: 12px; font-weight: 500; text-transform: uppercase; letter-spacing: 1px; color: var(--text-muted); margin-bottom: 8px; }
select, input[type="text"], input[type="number"], input[type="date"], input[type="time"], textarea {
  width: 100%; padding: 12px 16px; background: var(--input-bg); border: 1px solid var(--input-border);
  border-radius: 10px; color: var(--text); font-family: 'Inter', sans-serif; font-size: 15px;
  transition: border-color 0.2s; -webkit-appearance: none; appearance: none;
}
select { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%23888' viewBox='0 0 16 16'%3E%3Cpath d='M1.5 5.5l6.5 6.5 6.5-6.5'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 16px center; padding-right: 40px; cursor: pointer; }
input:focus, select:focus, textarea:focus { outline: none; border-color: var(--input-focus); box-shadow: 0 0 0 3px rgba(232,168,73,0.15); }
.btn { display: inline-flex; align-items: center; justify-content: center; padding: 14px 28px; border: none; border-radius: 10px; font-family: 'Inter', sans-serif; font-size: 15px; font-weight: 600; cursor: pointer; transition: all 0.2s; gap: 8px; }
.btn-primary { background: var(--accent); color: #000; width: 100%; margin-top: 24px; }
.btn-primary:hover { background: var(--accent-hover); transform: translateY(-1px); }
.btn-secondary { background: transparent; color: var(--text-muted); border: 1px solid var(--input-border); font-size: 13px; padding: 10px 20px; }
.btn-secondary:hover { border-color: var(--text-muted); color: var(--text); }
.dashboard-screen.active { min-height: 100vh; padding: 0; display: block !important; }
.top-bar { display: flex; align-items: center; justify-content: space-between; padding: 16px 32px; background: var(--card); border-bottom: 1px solid var(--card-border); position: sticky; top: 0; z-index: 100; }
.top-bar-brand { font-weight: 700; font-size: 16px; letter-spacing: 3px; text-transform: uppercase; color: var(--accent); }
.top-bar-user { display: flex; align-items: center; gap: 12px; color: var(--text-muted); font-size: 14px; }
.top-bar-user strong { color: var(--text); }
.dashboard-content { max-width: 900px; margin: 0 auto; padding: 32px 24px; }
.tabs { display: flex; gap: 4px; margin-bottom: 32px; background: var(--card); border-radius: 12px; padding: 4px; border: 1px solid var(--card-border); }
.tab-btn { flex: 1; padding: 12px 16px; background: transparent; border: none; border-radius: 9px; color: var(--text-muted); font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s; }
.tab-btn.active { background: var(--accent); color: #000; font-weight: 600; }
.tab-btn:not(.active):hover { color: var(--text); background: rgba(255,255,255,0.05); }
.invoice-form-card { background: var(--card); border: 1px solid var(--card-border); border-radius: 16px; padding: 36px 32px; }
.form-section-title { font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 2px; color: var(--accent); margin-bottom: 20px; padding-bottom: 12px; border-bottom: 1px solid var(--card-border); }
.form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px; }
.form-row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-bottom: 16px; }
.form-group { margin-bottom: 16px; }
.form-group label { display: block; font-size: 12px; font-weight: 500; color: var(--text-muted); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px; }
.line-items-preview { background: var(--input-bg); border: 1px solid var(--input-border); border-radius: 10px; padding: 14px 16px; font-size: 15px; color: var(--accent); font-weight: 500; min-height: 48px; display: flex; align-items: center; }
.line-items-preview.empty { color: var(--text-muted); font-weight: 400; font-style: italic; }
.invoice-num-toggle { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
.toggle-switch { position: relative; width: 44px; height: 24px; flex-shrink: 0; }
.toggle-switch input { opacity: 0; width: 0; height: 0; position: absolute; }
.toggle-slider { position: absolute; cursor: pointer; inset: 0; background: var(--input-border); border-radius: 24px; transition: 0.2s; }
.toggle-slider:before { content: ""; position: absolute; height: 18px; width: 18px; left: 3px; bottom: 3px; background: #fff; border-radius: 50%; transition: 0.2s; }
.toggle-switch input:checked + .toggle-slider { background: var(--accent); }
.toggle-switch input:checked + .toggle-slider:before { transform: translateX(20px); }
.toggle-label { font-size: 13px; color: var(--text-muted); }
.form-section { margin-bottom: 28px; }
.submit-row { display: flex; gap: 12px; margin-top: 28px; }
.submit-row .btn-primary { margin-top: 0; flex: 1; }
.history-empty { text-align: center; padding: 60px 20px; color: var(--text-muted); }
.history-empty-icon { font-size: 48px; margin-bottom: 16px; opacity: 0.3; }
.invoice-list { display: flex; flex-direction: column; gap: 12px; }
.invoice-item { background: var(--card); border: 1px solid var(--card-border); border-radius: 12px; padding: 20px 24px; display: grid; grid-template-columns: 1fr auto auto; gap: 16px; align-items: center; transition: border-color 0.2s; }
.invoice-item:hover { border-color: var(--accent); }
.invoice-item-info h4 { font-size: 15px; font-weight: 600; margin-bottom: 4px; }
.invoice-item-info p { font-size: 13px; color: var(--text-muted); }
.invoice-item-amount { font-size: 20px; font-weight: 700; color: var(--accent); }
.invoice-item-status { font-size: 12px; padding: 4px 12px; border-radius: 20px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px; }
.status-submitted { background: rgba(232,168,73,0.15); color: var(--accent); }
.status-paid { background: rgba(74,222,128,0.15); color: var(--success); }
.toast { position: fixed; bottom: 32px; right: 32px; background: var(--card); border: 1px solid var(--success); border-radius: 12px; padding: 16px 24px; display: flex; align-items: center; gap: 12px; font-size: 14px; font-weight: 500; z-index: 1000; transform: translateY(100px); opacity: 0; transition: all 0.3s ease; }
.toast.show { transform: translateY(0); opacity: 1; }
.toast-icon { color: var(--success); font-size: 20px; }
@media (max-width: 640px) {
  .form-row, .form-row-3 { grid-template-columns: 1fr; }
  .invoice-form-card { padding: 24px 16px; }
  .login-card { padding: 32px 24px; }
  .top-bar { padding: 12px 16px; }
  .dashboard-content { padding: 20px 12px; }
  .invoice-item { grid-template-columns: 1fr; gap: 8px; }
  .top-bar-user span { display: none; }
}
</style>
</head>
<body>
<div id="loginScreen" class="screen login-screen active">
  <div class="login-card">
    <div class="brand-logo">MARK CHILL</div>
    <div class="brand-sub">DJ Invoice Portal</div>
    <label class="dj-select-label">Select Your Name</label>
    <select id="djSelect">
      <option value="">Choose DJ...</option>
      <option value="DJ Belles">DJ Belles</option>
      <option value="DJ Elephante">DJ Elephante</option>
      <option value="DJ Kassi">DJ Kassi</option>
      <option value="DJ SMW">DJ SMW</option>
      <option value="DJ VW">DJ VW</option>
      <option value="DJ Gin Rummy">DJ Gin Rummy</option>
    </select>
    <button class="btn btn-primary" onclick="enterPortal()">Enter Portal</button>
  </div>
</div>
<div id="dashboardScreen" class="screen dashboard-screen">
  <div class="top-bar">
    <div class="top-bar-brand">MARK CHILL</div>
    <div class="top-bar-user">
      <span>Logged in as <strong id="topBarDJ"></strong></span>
      <button class="btn btn-secondary" onclick="logout()">Switch DJ</button>
    </div>
  </div>
  <div class="dashboard-content">
    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab('new')">New Invoice</button>
      <button class="tab-btn" onclick="switchTab('history')">My Invoices</button>
    </div>
    <div id="tabNew" class="tab-content">
      <div class="invoice-form-card">
        <div class="form-section">
          <div class="form-section-title">Invoice Details</div>
          <div class="invoice-num-toggle">
            <label class="toggle-switch"><input type="checkbox" id="autoNumberToggle" checked onchange="toggleAutoNumber()"><span class="toggle-slider"></span></label>
            <span class="toggle-label">Auto-number my invoices</span>
          </div>
          <div class="form-row">
            <div class="form-group"><label>Invoice Number</label><input type="text" id="invoiceNumber" value="" readonly></div>
            <div class="form-group"><label>Due Date</label><input type="date" id="dueDate"></div>
          </div>
        </div>
        <div class="form-section">
          <div class="form-section-title">Gig Details</div>
          <div class="form-group"><label>Venue</label>
            <select id="venueSelect" onchange="updateLineItems()"><option value="">Select venue...</option><option value="Belles">Belles</option><option value="Elephante">Elephante</option><option value="Kassi">Kassi</option><option value="SMW">SMW</option><option value="VW">VW</option><option value="Gin Rummy">Gin Rummy</option><option value="Private Event">Private Event</option></select>
          </div>
          <div class="form-row-3">
            <div class="form-group"><label>Month</label><select id="monthSelect" onchange="updateLineItems()"><option value="">Mo</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select></div>
            <div class="form-group"><label>Day</label><select id="daySelect" onchange="updateLineItems()"><option value="">Day</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option></select></div>
            <div class="form-group"><label>Day of Week</label><select id="dowSelect" onchange="updateLineItems()"><option value="">Day...</option><option value="Monday">Monday</option><option value="Tuesday">Tuesday</option><option value="Wednesday">Wednesday</option><option value="Thursday">Thursday</option><option value="Friday">Friday</option><option value="Saturday">Saturday</option><option value="Sunday">Sunday</option></select></div>
          </div>
          <div class="form-row">
            <div class="form-group"><label>Time In</label><input type="time" id="timeIn" onchange="updateLineItems()"></div>
            <div class="form-group"><label>Time Out</label><input type="time" id="timeOut" onchange="updateLineItems()"></div>
          </div>
        </div>
        <div class="form-section">
          <div class="form-section-title">Line Items (Auto-Generated)</div>
          <div class="form-group"><label>Preview</label><div id="lineItemsPreview" class="line-items-preview empty">Fill in gig details above...</div></div>
        </div>
        <div class="form-section">
          <div class="form-section-title">Payment</div>
          <div class="form-group"><label>Total Price ($)</label><input type="number" id="totalPrice" placeholder="0.00" min="0" step="0.01"></div>
        </div>
        <div class="submit-row"><button class="btn btn-primary" onclick="submitInvoice()">Submit Invoice</button></div>
      </div>
    </div>
    <div id="tabHistory" class="tab-content" style="display:none;"><div id="invoiceHistoryList"></div></div>
  </div>
</div>
<div id="toast" class="toast"><span class="toast-icon">&#10003;</span><span id="toastMsg">Invoice submitted!</span></div>
<script>
let currentDJ='';let invoices={};
function loadState(){try{const s=localStorage.getItem('mchill_invoices');if(s)invoices=JSON.parse(s)}catch(e){}}
function saveState(){localStorage.setItem('mchill_invoices',JSON.stringify(invoices))}
function getDJInvoices(){if(!invoices[currentDJ])invoices[currentDJ]=[];return invoices[currentDJ]}
function getNextInvoiceNumber(){return getDJInvoices().length+1}
function enterPortal(){const sel=document.getElementById('djSelect');if(!sel.value){sel.style.borderColor='#f87171';setTimeout(()=>sel.style.borderColor='',1500);return}currentDJ=sel.value;document.getElementById('topBarDJ').textContent=currentDJ;document.getElementById('loginScreen').classList.remove('active');document.getElementById('dashboardScreen').classList.add('active');initForm()}
function logout(){currentDJ='';document.getElementById('dashboardScreen').classList.remove('active');document.getElementById('loginScreen').classList.add('active');document.getElementById('djSelect').value=''}
function switchTab(tab){document.querySelectorAll('.tab-btn').forEach((b,i)=>{b.classList.toggle('active',(tab==='new'&&i===0)||(tab==='history'&&i===1))});document.getElementById('tabNew').style.display=tab==='new'?'block':'none';document.getElementById('tabHistory').style.display=tab==='history'?'block':'none';if(tab==='history')renderHistory()}
function initForm(){const d=new Date();d.setDate(d.getDate()+14);document.getElementById('dueDate').value=d.toISOString().split('T')[0];toggleAutoNumber();document.getElementById('venueSelect').value='';document.getElementById('monthSelect').value='';document.getElementById('daySelect').value='';document.getElementById('dowSelect').value='';document.getElementById('timeIn').value='';document.getElementById('timeOut').value='';document.getElementById('totalPrice').value='';updateLineItems()}
function toggleAutoNumber(){const auto=document.getElementById('autoNumberToggle').checked;const inp=document.getElementById('invoiceNumber');if(auto){inp.value=getNextInvoiceNumber();inp.readOnly=true;inp.style.opacity='0.6'}else{inp.value='';inp.readOnly=false;inp.style.opacity='1';inp.placeholder='Enter invoice #'}}
function formatTime(t){if(!t)return'';const[h,m]=t.split(':').map(Number);let h12=h%12;if(h12===0)h12=12;let f=''+h12;if(m>0)f+=(m<10?'0'+m:m);f+=(h>=12?'P':'A');return f}
function updateLineItems(){const venue=document.getElementById('venueSelect').value;const month=document.getElementById('monthSelect').value;const day=document.getElementById('daySelect').value;const dow=document.getElementById('dowSelect').value;const timeIn=document.getElementById('timeIn').value;const timeOut=document.getElementById('timeOut').value;const preview=document.getElementById('lineItemsPreview');if(!venue&&!month&&!day){preview.textContent='Fill in gig details above...';preview.classList.add('empty');return}let parts=[];if(currentDJ)parts.push(currentDJ);if(month&&day)parts.push(month+'/'+day);if(dow)parts.push(dow);if(timeIn&&timeOut)parts.push(formatTime(timeIn)+'-'+formatTime(timeOut));else if(timeIn)parts.push(formatTime(timeIn));if(parts.length>0){preview.textContent=parts.join(' ');preview.classList.remove('empty')}else{preview.textContent='Fill in gig details above...';preview.classList.add('empty')}}
function submitInvoice(){const venue=document.getElementById('venueSelect').value;const month=document.getElementById('monthSelect').value;const day=document.getElementById('daySelect').value;const dow=document.getElementById('dowSelect').value;const timeIn=document.getElementById('timeIn').value;const timeOut=document.getElementById('timeOut').value;const totalPrice=document.getElementById('totalPrice').value;const invoiceNum=document.getElementById('invoiceNumber').value;const dueDate=document.getElementById('dueDate').value;if(!venue||!month||!day||!dow||!timeIn||!timeOut||!totalPrice){showToast('Please fill in all fields',true);return}const lineItems=document.getElementById('lineItemsPreview').textContent;const invoiceData={id:Date.now(),djName:currentDJ,invoiceNumber:invoiceNum,dueDate:dueDate,venue:venue,month:month,day:day,dayOfWeek:dow,timeIn:timeIn,timeOut:timeOut,lineItems:lineItems,totalPrice:parseFloat(totalPrice).toFixed(2),submittedAt:new Date().toISOString(),status:'submitted'};getDJInvoices().push(invoiceData);saveState();sendToWebhook(invoiceData);showToast('Invoice #'+invoiceNum+' submitted!');setTimeout(()=>initForm(),500)}
async function sendToWebhook(data){const WEBHOOK_URL='';if(!WEBHOOK_URL){console.log('Webhook not configured. Data:',JSON.stringify(data,null,2));return}try{await fetch(WEBHOOK_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)})}catch(err){console.error('Webhook failed:',err)}}
function renderHistory(){const list=document.getElementById('invoiceHistoryList');const djInv=getDJInvoices().slice().reverse();if(djInv.length===0){list.innerHTML='<div class="history-empty"><div class="history-empty-icon">\u{1F4CB}</div><p>No invoices yet.<br>Submit your first invoice to see it here.</p></div>';return}list.innerHTML='<div class="invoice-list">'+djInv.map(inv=>{const d=new Date(inv.submittedAt);const ds=(d.getMonth()+1)+'/'+d.getDate()+'/'+d.getFullYear();return'<div class="invoice-item"><div class="invoice-item-info"><h4>Invoice #'+inv.invoiceNumber+' \u2014 '+inv.venue+'</h4><p>'+inv.lineItems+' \u00B7 Submitted '+ds+'</p></div><div class="invoice-item-amount">$'+inv.totalPrice+'</div><span class="invoice-item-status status-'+inv.status+'">'+inv.status+'</span></div>'}).join('')+'</div>'}
function showToast(msg,isError){const toast=document.getElementById('toast');const icon=toast.querySelector('.toast-icon');document.getElementById('toastMsg').textContent=msg;icon.textContent=isError?'\u2715':'\u2713';toast.style.borderColor=isError?'var(--danger)':'var(--success)';icon.style.color=isError?'var(--danger)':'var(--success)';toast.classList.add('show');setTimeout(()=>toast.classList.remove('show'),3000)}
loadState();
</script>
</body>
</html>
